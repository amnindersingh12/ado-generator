<h2 class="text-center">Attendance Calendar - <%= Date::MONTHNAMES[@month] %> <%= @year %></h2>

<div class="d-flex justify-content-between mb-3">
  <%= link_to "Previous Month", history_calendar_path(year: @first_day.prev_month.year, month: @first_day.prev_month.month), class: "btn btn-outline-primary" %>
  <%= link_to "Next Month", history_calendar_path(year: @first_day.next_month.year, month: @first_day.next_month.month), class: "btn btn-outline-primary" %>
</div>

<table class="table table-bordered calendar">
  <thead>
    <tr>
      <% Date::ABBR_DAYNAMES.each do |day| %>
        <th><%= day %></th>
      <% end %>
    </tr>
  </thead>
  <tbody>
    <% start_date = @first_day.beginning_of_week(:sunday) %>
    <% end_date = @last_day.end_of_week(:sunday) %>

    <% (start_date..end_date).to_a.in_groups_of(7).each do |week| %>
      <tr>
        <% week.each do |date| %>
          <td class="<%= 'bg-light' if date.month != @month %>">
            <%= link_to date.day, calendar_day_path(year: date.year, month: date.month, day: date.day), class: "btn btn-sm #{'btn-outline-success' if @attendances_by_day[date]}" %>
          </td>
        <% end %>
      </tr>
    <% end %>
  </tbody>
</table>
